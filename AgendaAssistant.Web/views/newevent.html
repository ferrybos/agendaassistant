<div class="alert alert-success ontop" role="alert" ng-if="infoMessage.length > 0">{{infoMessage}}</div>
<div id="wrapper">
    <h1>{{constants.newEventTitle}}</h1>
    <div id="content">
        <div class="btn-group btn-group-justified" style="margin-bottom: 20px" ng-show="CurrentStepIndex != 9">
            <a role="button" class="sectionButton btn" ng-class="CurrentStepIndex == 1 ? 'btn-primary' : 'btn-default'" ng-click="SelectStepEvent()">Afspraak</a>
            <a role="button" class="sectionButton btn" ng-class="CurrentStepIndex == 2 ? 'btn-primary' : 'btn-default'" ng-click="IsEventStepValid() ? SelectStepParticipants() : null">Deelnemers</a>
            <a role="button" class="sectionButton btn" ng-class="CurrentStepIndex == 3 ? 'btn-primary' : 'btn-default'" ng-click="IsEventStepValid() && IsParticipantsStepValid() ? SelectStepOutbound() : null">Heen</a>
            <a role="button" class="sectionButton btn" ng-class="CurrentStepIndex == 4 ? 'btn-primary' : 'btn-default'" ng-click="IsEventStepValid() && IsParticipantsStepValid() && IsOutboundStepValid() ? SelectStepInbound() : null">Terug</a>
        </div>

        <div id="steps">
            <!--Step 1: Event-->
            <!--<neweventdetails event="event" iswaitingfornewevent="isWaitingForNewEvent" currentstepindex="CurrentStepIndex" ng-show="CurrentStepIndex == 1"></neweventdetails>-->
            <div ng-show="CurrentStepIndex == 1">
                <info ng-click="EnterTestEvent()">Vul hier uw afspraak gegevens in.</info>
                <form name="eventForm" novalidate ng-submit="SelectStepParticipants()">
                    <!--Title-->
                    <div class="form-group" show-errors='{showSuccess: true}'>
                        <input type="text" class="form-control" name="title" ng-model="event.title" focus-on="focusEventTitle" required autofocus placeholder="Titel (bijv. Weekendje Barcelona)" maxlength="50" autocomplete="off" style="width: 100%" />
                        <p class="help-block" ng-if="eventForm.title.$error.required">De titel is verplicht</p>
                    </div>
                    <!--Description-->
                    <textarea class="form-control" name="description" ng-model="event.description" rows="4" placeholder="Omschrijving" style="width: 100%"></textarea>
                    <h4>Organisator</h4>
                    <!--Naam-->
                    <div class="form-group" show-errors='{showSuccess: true}'>
                        <input type="text" class="form-control" name="name" ng-model="event.organizerName" required autofocus placeholder="Uw naam" style="width: 100%" maxlength="50" />
                        <p class="help-block" ng-if="eventForm.name.$error.required">De organisator's naam is verplicht</p>
                    </div>
                    <!--Email-->
                    <div class="form-group" show-errors='{showSuccess: true}'>
                        <input type="text" class="form-control" name="email" ng-model="event.organizerEmail" required autofocus placeholder="Uw emailadres" style="width: 100%" maxlength="100" />
                        <p class="help-block" ng-if="eventForm.email.$error.required">De organisator's email adres is verplicht</p>
                        <p class="help-block" ng-if="eventForm.email.$error.email">De organisator's email adres is onjuist</p>
                    </div>

                    <div class="form-group" ng-show="event.id == ''">
                        <input type="checkbox" ng-model="addParticipant" style="margin-right: 10px">Toevoegen als deelnemer aan de groep
                    </div>

                    <!--Buttons-->
                    <div class="tab_navigation">
                        <button type="button" class="btn btn-lg btn-link" style="float: left" id="cancelButton" ng-click="CancelNewEvent()">Annuleren</button>
                        <button type="submit" class="btn btn-lg btn-primary" style="float: right" ng-disabled="eventForm.$invalid">Volgende <span class="glyphicon glyphicon-arrow-right" style="margin-left: 4px"></span></button>
                    </div>
                </form>
            </div>

            <!--Step 2: Participants-->
            <!--<ng-include src="'partials/newEventParticipants.html'" ng-show="CurrentStepIndex == 2"></ng-include>-->
            <div id="content_step_participants" ng-show="CurrentStepIndex == 2">
                <info>Vul naam en email adres in en druk op Toevoegen om deelnemers toe te voegen. Maximaal 9 deelnemers is toegestaan.</info>
                <loader ng-if="isWaitingForNewEvent == true">Even geduld aub...</loader>
                <form ng-submit="AddParticipant()" ng-show="event.participants.length < 9" name="participantsForm" novalidate>
                    <input ng-model="newParticipantName" focus-on="focusParticipantName" type="text" name="participant_name" id="participant_name" maxlength="50" autocomplete="off" class="form-control" placeholder="Naam" style="width: 100%" required />
                    <input ng-model="newParticipantEmail" type="email" name="participant_email" maxlength="100" autocomplete="off" class="form-control" placeholder="Emailadres" style="width: 100%" required />
                    <button type="submit" class="btn btn-sm btn-primary" style="width: 100%; margin-top: 10px"><span class="glyphicon glyphicon-plus"></span>Toevoegen</button>
                </form>
                <h4>Deelnemers ({{event.participants.length}})</h4>
                <div class="list-group">
                    <div ng-repeat="participant in event.participants" class="repeat-animation">
                        <a class="list-group-item" style="cursor: pointer">
                            <button ng-click="DeleteParticipant($index)" class="btn btn-danger btn-sm" style="float: right; margin-top: 5px" title="Deelnemer verwijderen"><span class="glyphicon glyphicon-minus"></span></button>
                            <h4 class="list-group-item-heading">{{participant.person.name}}</h4>
                            <p class="list-group-item-text">{{participant.person.email}}</p>
                        </a>
                    </div>
                </div>
                <div class="tab_navigation">
                    <button type="button" class="btn btn-lg btn-primary" style="float: left" ng-click="SelectStepEvent()"><span class="glyphicon glyphicon-arrow-left"></span>Vorige</button>
                    <button type="button" class="btn btn-lg btn-primary" style="float: right" ng-click="SelectStepOutbound()" ng-disabled="!IsParticipantsStepValid()">Volgende <span class="glyphicon glyphicon-arrow-right"></span></button>
                </div>
            </div>

            <!--Step 3: Outbound flight search-->
            <!--<ng-include src="'partials/newEventOutbound.html'" ng-show="CurrentStepIndex == 3"></ng-include>-->
            <div id="content_step_outbound" ng-show="CurrentStepIndex == 3">
                <info>Voeg heenvluchten toe door beschikbare vluchten te zoeken en te selecteren. Wanneer je alleen op specifieke dagen wilt reizen, kun je weekdagen uit- of aanzetten. Met de maximum prijs kun je een budget per vlucht aangeven.</info>
                <flight-search flightsearch="event.outboundFlightSearch" isoutbound="true" flights="outboundFlights" paxcount="event.participants.length" departurestations="origins" arrivalstations="destinations" routes="routes"></flight-search>
                <div class="tab_navigation">
                    <button type="button" class="btn btn-lg btn-primary" style="float: left" ng-click="SelectStepParticipants()"><span class="glyphicon glyphicon-arrow-left"></span>Vorige</button>
                    <button type="button" class="btn btn-lg btn-primary" style="float: right" ng-click="SelectStepInbound()" ng-disabled="!IsOutboundStepValid()">Volgende <span class="glyphicon glyphicon-arrow-right"></span></button>
                </div>
            </div>

            <!--Step 4: Inbound flight search-->
            <!-- <ng-include src="'partials/newEventInbound.html'" ng-show="CurrentStepIndex == 4"></ng-include>-->
            <div id="content_step_inbound" ng-show="CurrentStepIndex == 4">
                <info>Voeg terugvluchten toe door beschikbare vluchten te zoeken en te selecteren.</info>
                <flight-search flightsearch="event.inboundFlightSearch" isoutbound="false" flights="inboundFlights" paxcount="event.participants.length" departurestations="destinations" arrivalstations="origins" routes="routes"></flight-search>
                <div class="tab_navigation">
                    <button type="button" class="btn btn-lg btn-primary" style="float: left" ng-click="SelectStepOutbound()"><span class="glyphicon glyphicon-arrow-left"></span>Vorige</button>
                    <button type="button" class="btn btn-lg btn-success" style="float: right" ng-click="CreateEvent()" ng-disabled="!IsInboundStepValid()">Opslaan <span class="glyphicon glyphicon-ok"></span></button>
                </div>
            </div>

            <loader ng-if="CurrentStepIndex == 9">Afspraak wordt nu aangemaakt. Even geduld aub...</loader>
        </div>
    </div>
</div>
